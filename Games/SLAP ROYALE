local ARGS = {...}
local WINDOW = ARGS[1]
local NOTIFICATION = ARGS[2]
local MAIN_TAB = WINDOW:MakeTab({
   Name = "MAIN",
   Icon = nil,
   PremiumOnly = false
})
local ITEM_GRABBER = WINDOW:MakeTab({
   Name = "ITEM GRABBER",
   Icon = nil,
   PremiumOnly = false
})

local Items = {
 [1] = {
   ["Name"] = "Power",
   "Bull's essence",
   "Sphere of fury",
   "True Power",
   "Cube of Ice"
 },
 [2] = {
  ["Name"] = "Potions",
  "Healing Potion", 
  "Speed Potion",
  "Lightning Potion",
  "Frog Potion",
  "Potion of Strength"
 },
 [3] = {
  ["Name"] = "Healing",
  "Bandage",
  "First Aid Kit", 
  "Apple"
 },
 [4] = {
  ["Name"] = "Misc",
  "Boba",
  "Forcefield Crystal" 
 }
}

local SlapNearest = false
local NearestPlayer = nil
local NearestText = nil
local GetNearestPlayer = function()
   local cam = workspace.CurrentCamera
   local dist = 99999
   local player;
   
   pcall(function(...)
   for i,v in pairs(game.Players:GetChildren()) do if v ~= game.Players.LocalPlayer and v.Character then
         local newdist = (game.Players.LocalPlayer.Character.Torso.CFrame.p - v.Character.Torso.CFrame.p).Magnitude
         if newdist < dist then
            dist = newdist
            player = v
         end
      end 
   end
   end)
   
   if player.Character then
      return player,dist
   end
end
local GetLeg = function()
   local Legs = {"Left Leg", "Right Leg"}
   
   return game:GetService("Players").LocalPlayer.Character[Legs[math.random(1, #Legs)]]
end

local FindItem = function(Name)
   if workspace:FindFirstChild(Name) then
      
      local Item = workspace:FindFirstChild(Name)
      
      if (Item:IsA("Tool") and Item:FindFirstChild("Handle")) then
         
         local Handle = Item:FindFirstChild("Handle")
         local TouchP = GetLeg()
         
         firetouchinterest(TouchP, Handle, 0)
         firetouchinterest(TouchP, Handle, 1)   
         
         return true
      end
   end
   
   return false
end

local GA = ITEM_GRABBER:AddSection({
  Name = "EVERYTHING",
})

GA:AddButton({
  Name = "GRAB ALL",
  Callback = function()
 
    if game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("Countdown") then
        NOTIFICATION("ERROR", "WAIT FOR THE GAME TO START!", 5, nil)
           
        return
     end
     for i, v in pairs(Items) do
        for z, x in pairs(v) do
           if z ~= "Name" then
              if workspace:FindFirstChild(x) then
                  FindItem(x)
              end
           end
        end
     end
  end
})

for i, v in pairs(Items) do
   local Section = ITEM_GRABBER:AddSection({Name = v["Name"]:upper()})
   local FoundSection = false
   
   for z, x in pairs(v) do
      if workspace:FindFirstChild(x) then
         Section:AddButton({
           Name = "GET [" .. x:upper() .. "]",
           Callback = function(...)
              if game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("Countdown") then
                 NOTIFICATION("ERROR", "WAIT FOR THE GAME TO START!", 5, nil)
           
                 return
              end
              local ItemFound = FindItem(x)
        
              if not ItemFound then
                 NOTIFICATION("ERROR", "ITEM WAS NOT FOUND!", 5, nil)
              end
           end
         })
         FoundSection = true
      end
   end
   
   if not FoundSection then
      Section:AddLabel("NO ITEMS IN THIS CATEGORY WERE FOUND!")
   end
end

local TPS = MAIN_TAB:AddSection({Name = "TELEPORTS"})

TPS:AddButton({
  Name = "QUEUE",
  Callback = function(...)
     game:GetService("TeleportService"):Teleport(9426795465) 
  end
})

TPS:AddButton({
  Name = "PRIVATE",
  Callback = function(...)
     game:GetService("TeleportService"):Teleport(9431156611) 
  end
})

local OTH = MAIN_TAB:AddSection({Name = "SLAPPING"})
NearestText = OTH:AddLabel("NEAREST: NULL")
local GNP = OTH:AddToggle({
  Name = "SLAP NEAREST",
  Default = false,
  Callback = function(Bool)
     SlapNearest = Bool
  end
})

local OTH = MAIN_TAB:AddSection({Name = "OTHER"})

OTH:AddButton({
  Name = "Remove Zone",
  Callback = function()
     if workspace:FindFirstChild("Zone1") then
        workspace:FindFirstChild("Zone1"):Destroy()
     end
      if workspace:FindFirstChild("Zone2") then
        workspace:FindFirstChild("Zone2"):Destroy()
     end
  end
})

OTH:AddButton({
  Name = "Exploiter Check",
  Callback = function()
     local ToolCount = 0
     
     for i, v in pairs(workspace:GetChildren()) do
        if v:IsA("Tool") then ToolCount = ToolCount + 1 end
     end
     
     if ToolCount == 0 or ToolCount < 5 then
        NOTIFICATION("EXPLOITER CHECK", "A POSSIBLE EXPLOITER IS IN THIS SERVER!", 10, nil)
     else
        NOTIFICATION("EXPLOITER CHECK", "NO EXPLOITERS FOUND IN THIS SERVER!", 5, nil)    
     end
  end
})

game:GetService("RunService").RenderStepped:Connect(function(...)
    if SlapNearest and not _G.DisabledForUser then
       local Player,Distance = GetNearestPlayer()
       local PlayerParts = {"HumanoidRootPart", "Torso", "Left Arm", "Right Arm", "Left Leg", "Right Leg", "Head"}
       local Part = PlayerParts[math.random(1, #PlayerParts)]
       
       if Player ~= nil then
          if NearestText ~= nil then NearestText:Set("NEAREST: " .. Player.Name .. " (" .. tostring(Distance) .. ")") end
          if Distance < 30 then
             game:GetService("ReplicatedStorage"):WaitForChild("Events"):WaitForChild("Slap"):FireServer(Player.Character[Part])
          end
       end
    end
end)

local Players = game:GetService("Players")
local ModCheck = function(Player)
   local GroupRole = Player:GetRoleInGroup(9950771)
   local ModRoles = {"Junior Staff", "Trial Staff", "Staff", "Senior Staff", "Staff Supervisor", "OVERSEER", "Owner"}
   
   if table.find(ModRoles, GroupRole) then
      NOTIFICATION("ALERT", ("MODERATOR FOUND: " .. Player.Name), 5, nil)
   else
      return
   end
end

Players.PlayerAdded:Connect(ModCheck)

for i, v in pairs(Players:GetPlayers()) do
   ModCheck(v)
end
